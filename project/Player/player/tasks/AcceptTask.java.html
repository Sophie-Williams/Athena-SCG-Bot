<html><head><title>AcceptTask.java</title></head>
<!-- HTMLized with the Beditor
     *c* Bryan Chadwick, 2003 -->
<style type='text/css'><!--
   .def{ color: #000000; }
   .grade{
      border: solid #FF0000 1px;
      background-color: #FFFF60;
   }
   .gcom{ font-weight: bold; background-color: #FFC0C0; }
   .com{ font-style: italic; color: #880000; }
   .keyw{ font-weight: bold; color: #000088; }
   .num{ color: #00AA00; }
   .func{ color: #BB7733; }
   .str{ color: #CC00AB; }
   .prim{ color: #0000FF; }
--></style>
<body><pre><span class="def">
</span><span class="keyw">package</span><span class="def"> player.tasks;

</span><span class="keyw">import</span><span class="def"> logging.Logger;
</span><span class="keyw">import</span><span class="def"> scg.Util;
</span><span class="keyw">import</span><span class="def"> scg.gen.AcceptTrans;
</span><span class="keyw">import</span><span class="def"> scg.gen.OfferedChallenge;
</span><span class="keyw">import</span><span class="def"> scg.gen.PlayerContext;
</span><span class="keyw">import</span><span class="def"> edu.neu.ccs.demeterf.lib.List;

</span><span class="com">/** Accept Challenges we want to solve... choose wisely :) */</span><span class="def">
</span><span class="keyw">public</span><span class="def"> </span><span class="keyw">class</span><span class="def"> AcceptTask {

    </span><span class="keyw">private</span><span class="def"> </span><span class="keyw">final</span><span class="def"> Logger log;

    </span><span class="com">/** Create a AcceptTask with the given Logger */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> </span><span class="func">AcceptTask</span><span class="def">(Logger l) {
        log = l;
    }

    </span><span class="com">/** Do the actual acceptances */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> List&lt;AcceptTrans&gt; </span><span class="func">accept</span><span class="def">(PlayerContext context){
        log.</span><span class="func">notify</span><span class="def">(</span><span class="str">"With Account: $"</span><span class="def">+context.</span><span class="func">getBalance</span><span class="def">());
        List&lt;OfferedChallenge&gt; chs = context.</span><span class="func">getTheirOffered</span><span class="def">();
        </span><span class="keyw">return</span><span class="def"> chs.</span><span class="func">fold</span><span class="def">(</span><span class="keyw">new</span><span class="def"> List.Fold&lt;OfferedChallenge, Accepts&gt;() {
            </span><span class="keyw">public</span><span class="def"> Accepts </span><span class="func">fold</span><span class="def">(OfferedChallenge off, Accepts acc){
                </span><span class="keyw">if</span><span class="def"> (!acc.</span><span class="func">shouldAccept</span><span class="def">(off)) {
                    log.</span><span class="func">notify</span><span class="def">(</span><span class="str">"Not Accepting : #"</span><span class="def">+off.</span><span class="func">getKey</span><span class="def">());
                    </span><span class="keyw">return</span><span class="def"> acc;
                }
                log.</span><span class="func">notify</span><span class="def">(</span><span class="str">":) Accepting : #"</span><span class="def">+off.</span><span class="func">getKey</span><span class="def">());
                </span><span class="keyw">return</span><span class="def"> acc.</span><span class="func">doAccept</span><span class="def">(off);
            }
        }, Accepts.</span><span class="func">start</span><span class="def">(context.</span><span class="func">getBalance</span><span class="def">())).</span><span class="func">getTransactions</span><span class="def">();
    }

    </span><span class="com">/**
     * Keeps track of our account balance and what we've accepted so far.
     * Obviously more complicated schemes are possible (and suggested)
     */</span><span class="def">
    </span><span class="keyw">private</span><span class="def"> </span><span class="keyw">static</span><span class="def"> </span><span class="keyw">class</span><span class="def"> Accepts {

        </span><span class="keyw">double</span><span class="def"> account;
        List&lt;AcceptTrans&gt; toget;

        </span><span class="com">/** Private Constructor */</span><span class="def">
        </span><span class="keyw">private</span><span class="def"> </span><span class="func">Accepts</span><span class="def">(</span><span class="keyw">double</span><span class="def"> a, List&lt;AcceptTrans&gt; get) {
            account = a;
            toget = get;
        }

        </span><span class="com">/** Starts with the empty list of Accept Transactions */</span><span class="def">
        </span><span class="keyw">static</span><span class="def"> Accepts </span><span class="func">start</span><span class="def">(</span><span class="keyw">double</span><span class="def"> a){
            </span><span class="keyw">return</span><span class="def"> </span><span class="func">create</span><span class="def">(a, List.&lt;AcceptTrans&gt; </span><span class="func">create</span><span class="def">());
        }

        </span><span class="com">/** Create an Accepts Instance */</span><span class="def">
        </span><span class="keyw">static</span><span class="def"> Accepts </span><span class="func">create</span><span class="def">(</span><span class="keyw">double</span><span class="def"> a, List&lt;AcceptTrans&gt; get){
            </span><span class="keyw">return</span><span class="def"> </span><span class="keyw">new</span><span class="def"> </span><span class="func">Accepts</span><span class="def">(a, get);
        }

        </span><span class="com">/** Should this OfferedChallenge be accepted? Change this to implement your
         *    Challenge selection choices. */</span><span class="def">
        </span><span class="keyw">boolean</span><span class="def"> </span><span class="func">shouldAccept</span><span class="def">(OfferedChallenge off){
            </span><span class="keyw">return</span><span class="def"> off.</span><span class="func">getPrice</span><span class="def">() &lt; account && Util.</span><span class="func">coinFlip</span><span class="def">();
        }

        </span><span class="com">/** Do the 'accepting' of the Challenge */</span><span class="def">
        Accepts </span><span class="func">doAccept</span><span class="def">(OfferedChallenge off){
            </span><span class="keyw">return</span><span class="def"> </span><span class="func">create</span><span class="def">(account - off.</span><span class="func">getPrice</span><span class="def">(), toget.</span><span class="func">push</span><span class="def">(</span><span class="keyw">new</span><span class="def"> </span><span class="func">AcceptTrans</span><span class="def">(off.</span><span class="func">getKey</span><span class="def">())));
        }

        </span><span class="com">/** Return the accumulated Accept Transactions */</span><span class="def">
        </span><span class="keyw">public</span><span class="def"> List&lt;AcceptTrans&gt; </span><span class="func">getTransactions</span><span class="def">(){ </span><span class="keyw">return</span><span class="def"> toget; }
    }
}
</span></pre></body></html>