<html><head><title>Player.java</title></head>
<!-- HTMLized with the Beditor
     *c* Bryan Chadwick, 2003 -->
<style type='text/css'><!--
   .def{ color: #000000; }
   .grade{
      border: solid #FF0000 1px;
      background-color: #FFFF60;
   }
   .gcom{ font-weight: bold; background-color: #FFC0C0; }
   .com{ font-style: italic; color: #880000; }
   .keyw{ font-weight: bold; color: #000088; }
   .num{ color: #00AA00; }
   .func{ color: #BB7733; }
   .str{ color: #CC00AB; }
   .prim{ color: #0000FF; }
--></style>
<body><pre><span class="def">
</span><span class="keyw">package</span><span class="def"> player;

</span><span class="keyw">import</span><span class="def"> logging.Logger;
</span><span class="keyw">import</span><span class="def"> player.tasks.AcceptTask;
</span><span class="keyw">import</span><span class="def"> player.tasks.OfferTask;
</span><span class="keyw">import</span><span class="def"> player.tasks.ProvideTask;
</span><span class="keyw">import</span><span class="def"> player.tasks.ReofferTask;
</span><span class="keyw">import</span><span class="def"> player.tasks.SolveTask;
</span><span class="keyw">import</span><span class="def"> scg.gen.AcceptedChallenge;
</span><span class="keyw">import</span><span class="def"> scg.gen.OfferedChallenge;
</span><span class="keyw">import</span><span class="def"> scg.gen.PlayerContext;
</span><span class="keyw">import</span><span class="def"> scg.gen.PlayerID;
</span><span class="keyw">import</span><span class="def"> scg.gen.PlayerTrans;
</span><span class="keyw">import</span><span class="def"> scg.gen.ProvidedChallenge;
</span><span class="keyw">import</span><span class="def"> scg.gen.Transaction;
</span><span class="keyw">import</span><span class="def"> edu.neu.ccs.demeterf.lib.List;

</span><span class="com">/**
 * Player class, responsible for taking a single turn. We deligate to separate
 * Tasks classes to make things a little easier to understand. See
 * {@link player.tasks Tasks}.
 */</span><span class="def">
</span><span class="keyw">public</span><span class="def"> </span><span class="keyw">class</span><span class="def"> Player {

    </span><span class="com">/** Team Name: change this to your team's name */</span><span class="def">
    </span><span class="keyw">private</span><span class="def"> </span><span class="keyw">final</span><span class="def"> </span><span class="prim">String</span><span class="def"> teamName = </span><span class="str">"GenericPlayer"</span><span class="def">;
    </span><span class="com">/** The context for this current turn */</span><span class="def">
    </span><span class="keyw">private</span><span class="def"> </span><span class="keyw">final</span><span class="def"> PlayerContext context;
    </span><span class="com">/** Logger instance for output */</span><span class="def">
    </span><span class="keyw">private</span><span class="def"> </span><span class="keyw">final</span><span class="def"> Logger log;

    </span><span class="com">/** Get our assigned ID from the context */</span><span class="def">
    </span><span class="keyw">private</span><span class="def"> PlayerID </span><span class="func">playerID</span><span class="def">(){ </span><span class="keyw">return</span><span class="def"> context.</span><span class="func">getId</span><span class="def">(); }

    </span><span class="keyw">private</span><span class="def"> </span><span class="func">Player</span><span class="def">(PlayerContext ctxt, Logger l) {
        context = ctxt;
        log = l;
    }

    </span><span class="com">/** Construct a new player with the given Context */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> </span><span class="keyw">static</span><span class="def"> Player </span><span class="func">create</span><span class="def">(PlayerContext ctxt, Logger l){
        </span><span class="keyw">return</span><span class="def"> </span><span class="keyw">new</span><span class="def"> </span><span class="func">Player</span><span class="def">(ctxt, l);
    }

    </span><span class="com">/** Get this Players Team Name */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> </span><span class="prim">String</span><span class="def"> </span><span class="func">getName</span><span class="def">(){ </span><span class="keyw">return</span><span class="def"> teamName; }

    </span><span class="com">/** Take a turn for this player */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> PlayerTrans </span><span class="func">play</span><span class="def">(){
        log.</span><span class="func">event</span><span class="def">(</span><span class="str">"Chance to Play..."</span><span class="def">);
        </span><span class="com">// Try to accept some of the offered challenges</span><span class="def">
        List&lt;Transaction&gt; accs = </span><span class="func">acceptChallenges</span><span class="def">();
        </span><span class="com">// If not then we must Reoffer</span><span class="def">
        </span><span class="keyw">if</span><span class="def"> (accs.</span><span class="func">isEmpty</span><span class="def">()) {
            accs = </span><span class="func">reofferChallenges</span><span class="def">();
        }
        </span><span class="com">// Create a player transaction from our ID and our other transactions </span><span class="def">
        </span><span class="keyw">return</span><span class="def"> </span><span class="keyw">new</span><span class="def"> </span><span class="func">PlayerTrans</span><span class="def">(</span><span class="func">playerID</span><span class="def">(), </span><span class="func">offerChallenges</span><span class="def">().</span><span class="func">append</span><span class="def">(
                accs.</span><span class="func">append</span><span class="def">(</span><span class="func">provideChallenges</span><span class="def">().</span><span class="func">append</span><span class="def">(</span><span class="func">solveChallenges</span><span class="def">()))));
    }

    </span><span class="com">/** Offer new Challenges... that are not currently offered */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> List&lt;Transaction&gt; </span><span class="func">offerChallenges</span><span class="def">(){
        log.</span><span class="func">event</span><span class="def">(</span><span class="str">"Running Offer"</span><span class="def">);
        </span><span class="keyw">return</span><span class="def"> (List) </span><span class="keyw">new</span><span class="def"> </span><span class="func">OfferTask</span><span class="def">(log).</span><span class="func">offer</span><span class="def">(context);
    }

    </span><span class="com">/** Accept Challenges that seem reasonable/profitable */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> List&lt;Transaction&gt; </span><span class="func">acceptChallenges</span><span class="def">(){
        log.</span><span class="func">event</span><span class="def">(</span><span class="str">"Running Accept"</span><span class="def">);
        </span><span class="keyw">return</span><span class="def"> (List) </span><span class="keyw">new</span><span class="def"> </span><span class="func">AcceptTask</span><span class="def">(log).</span><span class="func">accept</span><span class="def">(context);
    }

    </span><span class="com">/** Reoffer other Player's Challenges */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> List&lt;Transaction&gt; </span><span class="func">reofferChallenges</span><span class="def">(){
        log.</span><span class="func">event</span><span class="def">(</span><span class="str">"Running Reoffer"</span><span class="def">);
        </span><span class="keyw">final</span><span class="def"> ReofferTask reoff = </span><span class="keyw">new</span><span class="def"> </span><span class="func">ReofferTask</span><span class="def">(log);
        </span><span class="keyw">return</span><span class="def"> context.</span><span class="func">getTheirOffered</span><span class="def">().</span><span class="func">map</span><span class="def">(</span><span class="keyw">new</span><span class="def"> List.Map&lt;OfferedChallenge, Transaction&gt;() {

            @Override
            </span><span class="keyw">public</span><span class="def"> Transaction </span><span class="func">map</span><span class="def">(OfferedChallenge ch){
                </span><span class="keyw">return</span><span class="def"> reoff.</span><span class="func">reoffer</span><span class="def">(ch, context.</span><span class="func">getConfig</span><span class="def">());
            }
        });
    }

    </span><span class="com">/** Provide Problem instances for accepted Challenges */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> List&lt;Transaction&gt; </span><span class="func">provideChallenges</span><span class="def">(){
        log.</span><span class="func">event</span><span class="def">(</span><span class="str">"Running Provide"</span><span class="def">);
        </span><span class="keyw">final</span><span class="def"> ProvideTask prov = </span><span class="keyw">new</span><span class="def"> </span><span class="func">ProvideTask</span><span class="def">(log);
        </span><span class="keyw">return</span><span class="def"> context.</span><span class="func">getAccepted</span><span class="def">().</span><span class="func">map</span><span class="def">(</span><span class="keyw">new</span><span class="def"> List.Map&lt;AcceptedChallenge, Transaction&gt;() {
            </span><span class="keyw">public</span><span class="def"> Transaction </span><span class="func">map</span><span class="def">(AcceptedChallenge ch){
                </span><span class="keyw">return</span><span class="def"> prov.</span><span class="func">provide</span><span class="def">(ch);
            }
        });
    }

    </span><span class="com">/** Solve provided Problem instances */</span><span class="def">
    </span><span class="keyw">public</span><span class="def"> List&lt;Transaction&gt; </span><span class="func">solveChallenges</span><span class="def">(){
        log.</span><span class="func">event</span><span class="def">(</span><span class="str">"Running Solve"</span><span class="def">);
        </span><span class="keyw">final</span><span class="def"> SolveTask solve = </span><span class="keyw">new</span><span class="def"> </span><span class="func">SolveTask</span><span class="def">(log);
        </span><span class="keyw">return</span><span class="def"> context.</span><span class="func">getProvided</span><span class="def">().</span><span class="func">map</span><span class="def">(</span><span class="keyw">new</span><span class="def"> List.Map&lt;ProvidedChallenge, Transaction&gt;() {
            </span><span class="keyw">public</span><span class="def"> Transaction </span><span class="func">map</span><span class="def">(ProvidedChallenge ch){
                </span><span class="keyw">return</span><span class="def"> solve.</span><span class="func">solve</span><span class="def">(ch);
            }
        });
    }
}
</span></pre></body></html>